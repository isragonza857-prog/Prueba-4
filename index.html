<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>BuzÃ³n de Amor ðŸ’Œ</title>
    <style>
        :root { --rosa: #ff4d6d; --texto: #590d22; }
        body { 
            background-image: url('https://i.postimg.cc/LXs6wcwy/65a54829cbbe07a6302459f35420ec2e.jpg');
            background-size: cover; background-position: center; background-attachment: fixed;
            font-family: sans-serif; margin: 0; padding: 10px; display: flex; flex-direction: column; align-items: center; color: var(--texto);
        }
        h1 { margin: 15px 0; font-size: 1.5rem; text-align: center; background: rgba(255, 255, 255, 0.7); padding: 8px 20px; border-radius: 50px; backdrop-filter: blur(4px); }
        .btn-notif { background: var(--rosa); color: white; border: none; padding: 12px 25px; border-radius: 25px; font-weight: bold; margin-bottom: 20px; cursor: pointer; box-shadow: 0 4px 10px rgba(0,0,0,0.2); }
        #contenedor { width: 100%; max-width: 400px; }
        .carta { background: rgba(255, 255, 255, 0.9); padding: 15px; margin-bottom: 12px; border-radius: 15px; border-left: 6px solid var(--rosa); box-shadow: 0 4px 10px rgba(0,0,0,0.1); }
        .bloqueada { background: rgba(255, 255, 255, 0.6); border-left-color: #adb5bd; text-align: center; }
        .tag { display: block; font-size: 0.7rem; color: var(--rosa); font-weight: bold; margin-bottom: 4px; }
        .proxima { font-weight: bold; font-size: 1.1rem; color: var(--texto); margin: 5px 0; }
    </style>
</head>
<body>

    <h1>ðŸ’Œ Nuestro BuzÃ³n</h1>
    <button class="btn-notif" id="btnNotif" onclick="pedirPermiso()">ðŸ”” Activar Notificaciones</button>
    <div id="contenedor"></div>

    <script>
        const frasesOriginales = ["Â¡Te amo! â¤ï¸", "Eres mi sol â˜€ï¸", "Mi lugar favorito eres tÃº ðŸ ", "Eres mi vida ðŸ˜", "Te extraÃ±o ðŸŒ¹", "Siempre juntos ðŸ‘©â€â¤ï¸â€ðŸ‘¨", "Eres magia âœ¨", "Mi mundo entero ðŸŒŽ", "Gracias por existir ðŸ¤—", "Te pienso siempre ðŸ’­", "Eres mi sueÃ±o hecho realidad ðŸŒ™", "Eres mi todo ðŸ’–", "Te amo cada dÃ­a mÃ¡s ðŸ“ˆ", "Eres mi debilidad ðŸ’‹", "Me haces muy feliz ðŸ˜Š", "Contigo todo es mejor ðŸŒŸ", "Eres Ãºnica ðŸ’Ž", "Mi corazÃ³n late por ti ðŸ’“", "Eres mi mejor regalo ðŸŽ", "Te quiero hoy y siempre â™¾ï¸", "Eres mi paz ðŸ•Šï¸", "Brillas mÃ¡s que el sol â˜€ï¸", "Eres mi hogar ðŸ—ï¸", "Te amo infinito ðŸŒŒ", "Eres mi tesoro ðŸ’°", "Eres mi persona favorita ðŸ¥°", "Te amo demasiado ðŸ’˜", "Mi razÃ³n de sonreÃ­r ðŸ˜", "Eres mi bendiciÃ³n ðŸ™", "Mi alma gemela ðŸ§©", "Te amo locamente ðŸ¤ª", "Eres mi motivaciÃ³n ðŸ’ª", "Siempre en mi mente ðŸ§ ", "Eres mi alegrÃ­a ðŸ˜„", "Te adoro ðŸ™‡â€â™‚ï¸", "Mi vida entera es tuya ðŸ’“", "Eres increÃ­ble ðŸŒˆ", "Mi amor por ti no tiene fin ðŸ›‘", "Eres mi Ã¡ngel ðŸ˜‡", "Te amo con toda mi alma ðŸ‘»", "Eres mi tesoro ðŸ’", "Te amo, preciosa ðŸ‘¸", "Eres mi suerte ðŸ€", "Te amo cada segundo â±ï¸", "Mi destino eres tÃº ðŸ›£ï¸", "Eres perfecta ðŸŽ¯", "Te amo, corazÃ³n ðŸ’–", "Eres mi cielo â˜ï¸", "Siempre tÃº ðŸ‘ˆ", "Te amo, hermosa ðŸŒ¸", "Mi refugio ðŸ°", "Eres mi luz ðŸ’¡", "Te amo tanto ðŸ”¥", "Mi todo ðŸ¥‡", "Eres mi calma ðŸŒŠ", "Te amo, amor de mi vida ðŸ’", "Eres mi realidad ðŸ‘“", "Siempre te elegirÃ© ðŸ—³ï¸", "Eres mi mejor aventura ðŸ§­", "Â¡Completamos un mes de amor! âœ¨"];

        const INTERVALO_MS = 12 * 3600000;

        function barajar(array) {
            let a = [...array];
            for (let i = a.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [a[i], a[j]] = [a[j], a[i]];
            }
            return a;
        }

        function pedirPermiso() {
            Notification.requestPermission().then(p => {
                if(p === "granted") document.getElementById('btnNotif').style.display = 'none';
            });
        }

        function actualizar() {
            const cont = document.getElementById('contenedor');
            const ahora = Date.now();
            let inicio = localStorage.getItem('I_V3');
            let orden = JSON.parse(localStorage.getItem('O_V3'));

            if (!inicio) {
                inicio = ahora;
                orden = barajar(frasesOriginales);
                localStorage.setItem('I_V3', inicio);
                localStorage.setItem('O_V3', JSON.stringify(orden));
            }

            let html = '';
            let proximaEncontrada = false;

            for (let i = 0; i < orden.length; i++) {
                const tiempoD = parseInt(inicio) + (i * INTERVALO_MS);
                
                if (ahora >= tiempoD) {
                    // Mensajes ya desbloqueados (del mÃ¡s nuevo al mÃ¡s viejo)
                    html = <div class="carta"><span class="tag">âœ¨ SORPRESA #${i+1}</span><p>${orden[i]}</p></div> + html;
                    
                    if (!localStorage.getItem('n_'+i) && i > 0) {
                        if (Notification.permission === "granted") new Notification("Â¡Nueva Carta! ðŸ’Œ");
                        localStorage.setItem('n_'+i, "true");
                    }
                } else if (!proximaEncontrada) {
                    // Solo mostramos UNA carta bloqueada (la siguiente)
                    const r = tiempoD - ahora;
                    const h = Math.floor(r / 3600000);
                    const m = Math.floor((r % 3600000) / 60000);
                    const s = Math.floor((r % 60000) / 1000);
                    
                    html = `<div class="carta bloqueada">
                                <span class="tag">ðŸ”’ PRÃ“XIMA SORPRESA EN:</span>
                                <div class="proxima">${h}h ${m}m ${s}s</div>
                            </div>` + html;
                    proximaEncontrada = true;
                }
            }
            cont.innerHTML = html;
        }

        if (Notification.permission === "granted") document.getElementById('btnNotif').style.display = 'none';
        setInterval(actualizar, 1000);
        actualizar();
    </script>
</body>
</html>
